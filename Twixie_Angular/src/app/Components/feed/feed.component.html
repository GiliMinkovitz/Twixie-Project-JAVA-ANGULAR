
<!-- הטריגר הראשי (מוסתר) -->
<input type="checkbox" id="drawer-toggle" class="drawer-toggle-checkbox">

<!-- תפריט צד (פילטרים) -->
<aside class="sidebar-filters">
    <div class="sidebar-header">
        <h3><i class="fas fa-sliders-h"></i> Filter Feed</h3>
        <label for="drawer-toggle" class="close-icon"><i class="fas fa-times"></i></label>
    </div>

    <div class="sidebar-content">
        <!-- עיצוב משודרג ל-SELECT -->
        <div class="filter-item">
            <label>Topic</label>
            <div class="fancy-select">
                <select (change)="filterByTopic($event)">
                    <option [value]="0">All Topics</option>
                    @for(category of categories; track $index){
                    <option [value]="category.name">{{category.name}}</option>
                    }
                </select>
                <!-- החץ המותאם אישית -->
                <i class="fas fa-chevron-down custom-arrow"></i>
            </div>
        </div>

        <div class="filter-item">
            <label>User</label>
            <div class="fancy-select">
                <select (change)="filterByPoster($event)">
                    <option [value]="0">All Posters</option>
                    @for(userName of userNames; track $index){
                    <option [value]="userName">{{userName}}</option>
                    }
                </select>
                <i class="fas fa-chevron-down custom-arrow"></i>
            </div>
        </div>

        <div class="filter-item">
            <label>Sort By</label>
            <div class="fancy-select">
                <select (change)="sort($event)">
                    <option [value]="0">Default</option>
                    <option [value]="1">Date: Newest</option>
                    <option [value]="2">Date: Oldest</option>
                    <option [value]="3">Name: A-Z</option>
                </select>
                <i class="fas fa-chevron-down custom-arrow"></i>
            </div>
        </div>
    </div>

    <div class="sidebar-footer">
        <label for="drawer-toggle" class="apply-btn">View Results</label>
    </div>
</aside>

<!-- Overlay כהה לרקע -->
<label for="drawer-toggle" class="backdrop-overlay"></label>


<!-- תוכן העמוד -->
<div class="page-container">

    <!-- תפריט עליון קבוע -->
        <app-menu-bar></app-menu-bar>

    <!-- אזור ראשי (התוכן יתחיל מתחת לתפריט) -->
    <main class="content-wrapper">

        <!-- שורת פעולות (חיפוש + פילטר) -->
        <div class="actions-header">
            <div class="search-bar-styled">
                <i class="fas fa-search search-icon"></i>
                <input type="text" placeholder="Search in feed..." (input)="search($event.target.value)">
            </div>

            <label for="drawer-toggle" class="filter-trigger">
                <span class="icon-circle"><i class="fas fa-filter"></i></span>
                <span class="text">Filters</span>
            </label>
        </div>

        <!-- גריד פוסטים -->
        <div class="posts-stream">
            @if(isLoading && postList.length === 0) {
                <div class="loading-state">
                    <div class="spinner"></div>
                    <p>Loading posts...</p>
                </div>
            } @else if(postList && postList.length > 0) {
                @for(post of postList; track $index){
                <div class="modern-card" (click)="toShowDetails(post)">
                    <div class="card-cover">
                        @if(post.imagePath){
                            <img src="data:image/jpeg;base64,{{ post.imagePath }}" />
                        } @else {
                            <div class="no-img-bg"><i class="fas fa-newspaper"></i></div>
                        }
                        <div class="floating-badge" >{{post.topicName}}</div>
                    </div>

                    <div class="card-details">
                        <div class="author-info">
                            <img src="data:image/jpeg;base64,{{ post.poster.picture }}" class="avatar-small" />
                            <div class="info-text">
                                <span class="author-name">{{post.poster.userName}}</span>
                                <span class="post-time">{{ post.lastUpdated | timeAgo }}</span>
                            </div>
                        </div>

                        <h3 class="post-headline">{{post.title}}</h3>
                        <p class="post-snippet">{{post.content}}</p>

                        <div class="card-action-link">
                            Read More <i class="fas fa-arrow-right"></i>
                        </div>
                    </div>
                </div>
                }
            } @else {
                <div class="empty-state">
                    <i class="far fa-sad-tear"></i>
                    <p>No posts found. Try adjusting your filters.</p>
                </div>
            }
        </div>
    </main>
</div>
